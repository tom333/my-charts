minio:
  replicas: 1
  mode: standalone
  persistence:
    size: 10Gi
  ingress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
      nginx.ingress.kubernetes.io/proxy-body-size: 1024m
    path: /
    hosts:
      - minio.tgu.ovh
    tls:
      - secretName: minio-tls
        hosts:
          - minio.tgu.ovh
  consoleIngress:
    enabled: true
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
    paths: /
    hosts:
      - minio-console.tgu.ovh
    tls:
      - secretName: minio-console-tls
        hosts:
          - minio-console.tgu.ovh
  environment:
    MINIO_BROWSER_REDIRECT_URL: https://minio-console.tgu.ovh

  existingSecret: minio-root-secret
  
mlflow: 
  # Flask server secret key - will be auto-generated if not set
  flaskServerSecretKey: ""

  postgresql:
    enabled: true
    auth:
      username: "mlflow"
      password: "mlflow"
      database: "mlflow"

  backendStore:
    databaseMigration: true
    # postgres section removed to avoid schema conflicts with postgresql subchart

  artifactRoot:
    s3:
      enabled: true
      bucket: "mlflow"
      existingSecret:
        name: "minio-root-secret"
        keyOfAccessKeyId: "rootUser"
        keyOfSecretAccessKey: "rootPassword"

  extraEnvVars:
    MLFLOW_S3_ENDPOINT_URL: "http://minio-service:9000"
    MLFLOW_S3_IGNORE_TLS: "true"

  # extraArgs:
  #   gunicornOpts: "--timeout 240"

  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: "letsencrypt-prod"
      nginx.ingress.kubernetes.io/proxy-body-size: 512m
      nginx.ingress.kubernetes.io/proxy-connect-timeout: 180s
      nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
    hosts:
      - host: mlflow.tgu.ovh
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls: 
     - secretName: mlflow-tls
       hosts:
         - mlflow.tgu.ovh

  service:
    type: ClusterIP
    port: 80
  
mysql:
  image:
    repository: bitnamilegacy/mysql
  auth:
    database: zenml
    username: zenml
    password: zenml
    rootPassword: password
  primary:
    livenessProbe:
        enabled: true
        initialDelaySeconds: 300
        periodSeconds: 10
        timeoutSeconds: 1
        failureThreshold: 45
        successThreshold: 1
    readinessProbe:
        enabled: true
        initialDelaySeconds: 300
        periodSeconds: 10
        timeoutSeconds: 1
        failureThreshold: 45
        successThreshold: 1
    startupProbe:
        enabled: true
        initialDelaySeconds: 300
        periodSeconds: 10
        timeoutSeconds: 1
        failureThreshold: 45
        successThreshold: 1
zenml:
  zenml:
    database:
      url: "mysql://zenml:zenml@lab-mysql.ia-lab.svc.cluster.local:3306/zenml"
    ingress:
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: "letsencrypt-prod"
      host: zenml.tgu.ovh
      tls:
        enabled: true
        secretName: zenml-tls-certs

# Persistence configuration
persistence:
 size: 10Gi
 accessMode: ReadWriteOnce
